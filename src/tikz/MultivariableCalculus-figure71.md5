\begingroup \toks 0={macro:-> \par \par \begin {axis}[grid=major,view={80}{25},zmin=-4, colormap/copper, name=plot0 ] \par \par \addplot 3[domain=-180:179, samples y=1, mypink, thick, smooth, densely dashed] ({cos(x)},{sin(x)},{-4}) node[near start, right, mypink, xshift=.1cm] {}; \par \addplot 3[surf, domain=-2:2, shader=interp, opacity=1, samples=20] {(x-2)^2+(y-3)^2}; \par \par \addplot 3[domain=0:360, samples y=1, mypink, thick, smooth] ({cos(x)},{sin(x)},{(cos(x)-2)^2+(sin(x)-3)^2}); \par \pgfplotsinvokeforeach {0,15,...,350} { \draw [fill={test!![##1]}, draw=none] ({cos(##1)}, {sin(##1)}, {(cos(##1)-2)^2+(sin(##1)-3)^2}) circle (1.5pt); } \par \draw (-.56, -.84 , 21.211) node (M1) {}; \end {axis} \par \begin {axis}[ at=(plot0.right of south east), xshift=.5cm, colormap/hsv, disabledatascaling, xmin=0,xmax=2*pi, ymin=6,ymax=22, x=.7cm,y=.3cm, grid=both, grid style={line width=.1pt, draw=gray!10}, axis lines=middle, minor tick num=0, axis line style={latex-latex}, xticklabels={,,}, xlabel={$t$}, ylabel={$z$}, xlabel style={at={(ticklabel* cs:1)},anchor=west}, ylabel style={at={(ticklabel* cs:1)},anchor=south} ] \par \par \par \par \addplot [domain=0:{2*pi}, samples=20, samples y=1, smooth,thick, mypink] (x, {-6*sin(deg(x))-4*cos(deg(x))+14}); \draw (4.124, 21.211) node (M2) {}; \pgfplotsinvokeforeach {0,15,...,350} { \par \draw [fill={test!![##1]}, draw=none] (##1/360*2*pi, {-6*sin(##1)-4*cos(##1)+14}) circle (1.5pt); } \draw (1.8,20) node (A){}; \end {axis} \par \draw (A) node[] {$z=f\circ \vec p(t)$}; \par \draw (plot0.north) node[above] {Corresponding extrema} edge[bend right, ->] (M1) edge[bend left, ->] (M2); }\xdef \tikzexternallastkey {\the \toks 0 }\endgroup %
