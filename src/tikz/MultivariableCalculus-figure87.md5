\begingroup \toks 0={macro:->[>=latex] \par \begin {axis}[grid=major,view={40}{40},xmin=-1.,xmax=1.,ymin=-1., ymax=1., zmin=-1.,zmax=1., name=plot0, colormap/copper, width=17cm, scale mode=scale uniformly, xticklabels={,,}, yticklabels={,,}, zticklabels={,,}, unbounded coords=jump, ] \addplot 3[surf, shader/interp, z buffer=sort,samples=40, samples y=20, variable=\u , variable y=\v , domain=-180:180, y domain=0:180] ({sin(u)*cos(v)},{sin(u)*sin(v)}, {cos(u)}); \par \addplot 3[surf, colormap/viridis, shader/interp, z buffer=sort,samples=8, samples y=8, variable=\u , variable y=\v , domain=41.5:60, y domain=0:19] ({sin(u)*cos(v)},{sin(u)*sin(v)}, {cos(u)}) node[midway] (A) {}; \par \foreach \v in {0} { \addplot 3[domain=0:180, samples y=1, white, densely dashed, smooth, variable=\u ] ({sin(u)*cos(\v )},{sin(u)*sin(\v )}, {cos(u)}); } \foreach \u in {60} { \addplot 3[domain=0:360, samples y=1, white, densely dashed, smooth, variable=\v ] ({sin(\u )*cos(v)},{sin(\u )*sin(v)}, {cos(\u )}); } \par \def \uu {60} \def \vv {0} \def \dd {.8} \def \ddd {.33} \par \coordinate (C) at ({sin(\uu )*cos(\vv )},{sin(\uu )*sin(\vv )}, {cos(\uu )}); \coordinate (D) at ({sin(\uu )*cos(\vv ) - \dd *cos(\uu )*cos(\vv )},{sin(\uu )*sin(\vv )-\dd *cos(\uu )*sin(\vv )}, {cos(\uu )+\dd *sin(\uu )}); \coordinate (E) at ({sin(\uu )*cos(\vv )-\dd *sin(\uu )*sin(\vv )},{sin(\uu )*sin(\vv )+\dd *sin(\uu )*cos(\vv )}, {cos(\uu )}); \par \par \coordinate (D2) at ({sin(\uu )*cos(\vv ) - \ddd *cos(\uu )*cos(\vv )},{sin(\uu )*sin(\vv )-\ddd *cos(\uu )*sin(\vv )}, {cos(\uu )+\ddd *sin(\uu )}); \coordinate (E2) at ({sin(\uu )*cos(\vv )-\ddd *sin(\uu )*sin(\vv )},{sin(\uu )*sin(\vv )+\ddd *sin(\uu )*cos(\vv )}, {cos(\uu )}); \coordinate (F2) at ({sin(\uu )*cos(\vv )-\ddd *sin(\uu )*sin(\vv ) - \ddd *cos(\uu )*cos(\vv ) },{sin(\uu )*sin(\vv )+\ddd *sin(\uu )*cos(\vv ) -\ddd *cos(\uu )*sin(\vv )}, {cos(\uu ) +\ddd *sin(\uu )}); \par \draw [draw=none, fill=blue, fill opacity=0.3] (C) -- (D2) -- (F2) -- (E2) -- cycle; \par \draw [->,thick,mygreen] (C) -- (D) node[left, black] {$\tfrac {\partial \vec p}{\partial a}(a,b)$}; \draw [->,thick,mypink] (C) -- (E); \draw [draw=none,fill=black] (C) circle (1.5pt) node[below left,yshift=-.1cm] {$\vec p(a,b) = L_{\vec p}(a,b)$}; \par \end {axis} \par \draw (E) node[right, black] {$\tfrac {\partial \vec p}{\partial b}(a,b)$}; \par \par \par \begin {axis}[grid=major,view={40}{40},xmin=-1.,xmax=1.,ymin=-1., ymax=1., zmin=-1.,zmax=1., name=plot1, at=(plot0.right of south east), xshift=1cm, colormap/copper, width=17cm, scale mode=scale uniformly, xticklabels={,,}, yticklabels={,,}, zticklabels={,,}, unbounded coords=jump, ] \addplot 3[surf, shader/interp, z buffer=sort,samples=40, samples y=20, variable=\u , variable y=\v , domain=-180:180, y domain=0:180] ({sin(u)*cos(v)},{sin(u)*sin(v)}, {cos(u)}); \par \addplot 3[surf, colormap/viridis, shader/interp, z buffer=sort,samples=8, samples y=8, variable=\u , variable y=\v , domain=41.5:60, y domain=0:19] ({sin(u)*cos(v)},{sin(u)*sin(v)}, {cos(u)}) node[midway] (AA) {}; \par \foreach \v in {0} { \addplot 3[domain=0:180, samples y=1, white, densely dashed, smooth, variable=\u ] ({sin(u)*cos(\v )},{sin(u)*sin(\v )}, {cos(u)}); } \foreach \u in {60} { \addplot 3[domain=0:360, samples y=1, white, densely dashed, smooth, variable=\v ] ({sin(\u )*cos(v)},{sin(\u )*sin(v)}, {cos(\u )}); } \par \def \uu {60} \def \vv {0} \def \dd {.8} \def \ddd {.33} \par \coordinate (C) at ({sin(\uu )*cos(\vv )},{sin(\uu )*sin(\vv )}, {cos(\uu )}); \draw [draw=none,fill=black] (C) circle (1.5pt) node[below left,yshift=-.1cm] {$\vec p(a,b)$}; \par \end {axis} \par \par \draw (plot0.north) node[above right, yshift=0cm, xshift=1cm] {Approximate sector} edge[bend left, ->,black,thick] (A); \draw (plot1.north) node[above right, yshift=0cm, xshift=1cm] {Exact sector} edge[bend left, ->,black,thick] (AA); \par }\xdef \tikzexternallastkey {\the \toks 0 }\endgroup %
