\begingroup \toks 0={macro:->[x=2cm,y=2cm, ] \par \begin {scope}[ spy using outlines={circle, lens={scale=4}, size=3cm, connect spies}] \coordinate (A) at (.3,.15*4); \coordinate (B) at (.4,.15*5); \fill [gray,opacity=.5] (A) rectangle (B); \par \par \begin {axis}[ anchor=origin, set layers=standard, disabledatascaling, xmin=-1,xmax=1, ymin=0,ymax=1, x=2cm,y=2cm, grid=both, grid style={line width=.1pt, draw=gray!10}, axis lines=middle, minor tick num=0, enlargelimits={abs=0.4}, axis line style={latex-latex}, ticklabel style={font=\tiny ,fill=white}, xlabel style={at={(ticklabel* cs:1)},anchor=north west}, ylabel style={at={(ticklabel* cs:1)},anchor=south west} ] \par \addplot [name path=f,no marks,mypink,thick,domain=-1:1, samples=25, draw=none] ({x},{x*x}); \addplot [no marks,mypink,thick,domain=-2:2, samples=25,smooth] ({x},{x*x}); \addplot [name path=g, no marks,green!50!black,thick,domain=-3:3, samples=2] ({x},{1}); \addplot [thick, color=blue, fill=blue, fill opacity=0.05] fill between [of=f and g, split]; \par \end {axis} \foreach \x in {-1,-.9,...,1} { \draw ($(\x ,1)$) -- ($(\x ,\x *\x )$); } \foreach \y in {0,.15,...,1} { \draw ({-\y ^.5,\y }) -- ({\y ^.5,\y }); } \par \par \spy [blue] on ($.5*(A)+.5*(B)$) in node (a) at (3,1); \par \par \end {scope} \coordinate (L) at ($(a.center) - (.2,.3)$); \coordinate (R) at ($(a.center) - (-.2,.3)$); \coordinate (T) at ($(a.center) + (.2,.3)$); \draw [decoration={brace, mirror}, decorate, mypink] ($(R)+(.03,0)$) -- ($(T)+(.03,0)$) node[midway, right] {$\Delta y$}; \draw [decoration={brace, mirror}, decorate,mypink] ($(L)-(0,.03)$) -- ($(R)-(0,.03)$) node[midway, below] {$\Delta x$}; \par \par }\xdef \tikzexternallastkey {\the \toks 0 }\endgroup %
